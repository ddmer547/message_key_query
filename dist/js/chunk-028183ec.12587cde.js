(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-028183ec"],{3715:function(e,t,a){"use strict";var i=a("b37b"),s=a.n(i);s.a},"38ef":function(e,t,a){},6875:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"patient"}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"关键查询"}},[a("childTemplete",{attrs:{tplName:"addTpl"}})],1)],1)],1)},s=[],n=(a("ac6a"),a("7f7f"),a("1157")),r=a.n(n),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",{staticClass:"flex",staticStyle:{margin:"20px","text-align":"center","align-self":"center"}},[a("el-card",{staticClass:"box-card"},[e._v("\n          今日门诊数量 "),a("br"),e._v("\n          "+e._s(e.outPantientNum)+"\n        ")]),a("el-card",{staticClass:"box-card"},[e._v("\n          今日住院数量 "),a("br"),e._v("\n          "+e._s(e.inPantientNum)+"\n        ")]),a("el-card",{staticClass:"box-card"},[e._v("\n          关键字消息量 "),a("br"),e._v("\n          "+e._s(e.keyMsgNum)+"\n        ")]),a("el-card",{staticClass:"box-card"},[e._v("\n          涉及服务数量 "),a("br"),e._v("\n          "+e._s(e.serviceAboutNum)+"\n        ")]),a("el-card",{staticClass:"box-card"},[e._v("\n          当前患者状态 "),a("br"),e._v("\n          "+e._s(e.nowPatientStatus)+"\n        ")])],1)]),a("div",{staticClass:"flex",staticStyle:{"margin-left":"10px"}},[a("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.send.form,"label-width":"70px"}},[a("el-form-item",{staticClass:"selet mgl5",attrs:{label:"关键字",size:"small"}},[a("el-select",{attrs:{placeholder:"不限"},model:{value:e.send.form.keyWord,callback:function(t){e.$set(e.send.form,"keyWord",t)},expression:"send.form.keyWord"}},[a("el-option",{attrs:{label:"患者姓名",value:"PatientName"}}),a("el-option",{attrs:{label:"患者ID",value:"PatientID"}}),a("el-option",{attrs:{label:"医嘱ID",value:"OrderID"}}),a("el-option",{attrs:{label:"患者身份证号",value:"IDCardNO"}}),a("el-option",{attrs:{label:"住院号",value:"InPatientNO"}}),a("el-option",{attrs:{label:"门诊号",value:"OutPatientNO"}})],1)],1),a("el-form-item",{attrs:{label:"关键值"}},[a("div",[a("el-input",{attrs:{placeholder:"请输入关键值"},model:{value:e.send.form.keyValue,callback:function(t){e.$set(e.send.form,"keyValue",t)},expression:"send.form.keyValue"}})],1)]),a("el-form-item",{attrs:{label:"服务名称"}},[a("div",[a("el-input",{attrs:{placeholder:"请输入服务名称"},model:{value:e.send.form.serviceNameEN,callback:function(t){e.$set(e.send.form,"serviceNameEN",t)},expression:"send.form.serviceNameEN"}})],1)]),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{attrs:{placeholder:"请输入开始时间",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.send.form.startTime,callback:function(t){e.$set(e.send.form,"startTime",t)},expression:"send.form.startTime"}})],1),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{attrs:{placeholder:"请输入结束时间",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.send.form.endTime,callback:function(t){e.$set(e.send.form,"endTime",t)},expression:"send.form.endTime"}})],1)],1)],1),a("div",{staticClass:"flex",staticStyle:{"margin-bottom":"20px"}},[a("div",[e._v("IP:")]),a("el-input",{attrs:{placeholder:"请输入IP端口"},model:{value:e.send.url,callback:function(t){e.$set(e.send,"url",t)},expression:"send.url"}}),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.sendClick}},[e._v("发送")])],1),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",width:"100"}}),a("el-table-column",{attrs:{prop:"serviceNameEN",label:"服务来源",width:"180"}}),a("el-table-column",{attrs:{prop:"serviceNameCN",label:"服务去向",width:"180"}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",width:"220"}}),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",width:"220"}}),a("el-table-column",{attrs:{prop:"Session",label:"sessionId",width:"180"}}),a("el-table-column",{attrs:{prop:"ESBStatus",label:"平台状态",width:"180"}}),a("el-table-column",{attrs:{prop:"otherStatus",label:"三方状态",width:"180"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.open(t.row.Session)}}},[e._v("跳转")])]}}])})],1)],1)])},l=[],c={name:"childTemplete",props:["isEdit","tplName"],data:function(){return{timeform:{startTime:new Date((new Date).setHours(0,0,0,0)),endTime:new Date((new Date).setHours(0,0,0,0)+864e5-1)},outPantientNum:0,inPantientNum:0,keyMsgNum:0,serviceAboutNum:0,nowPatientStatus:"未知",ipPort:"127.0.0.1:52773",activeName:"1",tableData:[],formHeight:"",send:{type:"json",url:"http://127.0.0.1:52777",form:{page:1,rows:500,keyWord:"PatientID",keyValue:"892170",serviceNameEN:"",startTime:new Date((new Date).setHours(0,0,0,0)),endTime:new Date((new Date).setHours(0,0,0,0)+864e5-1)}},searchObj:{formInline:{name:"",id:""},url:"http://192.168.100.49:52774/csp/healthshare/fhirserver/fhir/r4/Patient/"}}},created:function(){},mounted:function(){var e=this;this.getindex();this.$nextTick((function(){e.formHeight=r()(".form").height()-30}))},methods:{getindex:function(){var e=this;r.a.ajax({url:this.send.url+"/keyquery/api/GetKeyLogInfoNum",type:"POST",data:JSON.stringify(this.timeform),dataType:"json",contentType:"application/json",success:function(t,a,i){console.log(JSON.stringify(e.timeform)),console.log(t),e.outPantientNum=t.mznum,e.inPantientNum=t.zynum},error:function(t){e.$message.success("请求失败"+new Date)}})},open:function(e){var t=this;this.$prompt("请输入IP、端口和web应用程序url,例如:http://127.0.0.1:52773/url","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(a){var i=a.value;t.$message({type:"success",message:"你的IP和端口是: "+i}),t.ipPort=i,window.open(t.ipPort+"/EnsPortal.VisualTrace.zen?SESSIONID="+e)})).catch((function(){t.$message({type:"info",message:"取消输入"})}))},sendClick:function(){var e=this;console.log(" 请求接口 ");var t=this.send.form,a=this.send.url+"/keyquery/api/GetKeyLogInfo";console.log(t),r.a.ajax({url:a,type:"POST",async:!1,data:JSON.stringify(t),contentType:"application/json",success:function(t){console.log(t),e.keyMsgNum=t.total,e.serviceAboutNum=t.fwnum,e.nowPatientStatus=t.zt;var a=[],i={};t.data.forEach((function(e,t){i={ID:e.ID,serviceNameEN:e.serviceNameEN,serviceNameCN:e.serviceNameCN,startTime:e.startTime,endTime:e.endTime,Session:e.Session,ESBStatus:e.ESBStatus,otherStatus:e.otherStatus},a.push(i)})),e.tableData=a},error:function(e){console.log(e)}}),this.getindex()}},computed:{},components:{},watch:{}},d=c,u=(a("cdc6"),a("2877")),m=Object(u["a"])(d,o,l,!1,null,"16817899",null),f=m.exports,h={data:function(){return{showList:!1,showDetail:!1,showHis:!1,dataList:[],dataHisList:[],dataDetail:[],dataListTotal:"",hisTotal:"",searchObj:{formInline:{name:"",id:""},url:"http://192.168.100.49:52774/csp/healthshare/fhirserver/fhir/r4/Patient",urld:"http://192.168.100.49:52774/csp/healthshare/fhirserver/fhir/r4/Patient"},hisObj:{formInline:{name:"",id:""},url:"http://192.168.100.49:52774/csp/healthshare/fhirserver/fhir/r4/Patient"}}},components:{childTemplete:f},created:function(){},mounted:function(){var e=this;this.$nextTick((function(){r.a.ajaxSetup({statusCode:{200:function(){e.$message.success("请求成功"+new Date)},201:function(){e.$message.success("请求成功")},400:function(){e.$message.error("请求失败")},401:function(){e.$message.error("请求失败")},410:function(){e.$message.error("请求失败")},404:function(){e.$message.error("请求失败")},500:function(){e.$message.error("请求失败")},501:function(){e.$message.error("请求失败")}}})}))},methods:{deleteRow:function(e,t,a){console.log("deleteRow",e,t,a.id),this.deleteFn(a.id)},deletePat:function(){var e=this;r.a.ajax({url:this.searchObj.urld,type:"DELETE",data:{},contentType:"application/fhir+json",dataType:"json",success:function(t,a,i){e.$message.success("删除成功")},error:function(e){}})},deleteFn:function(e){var t=this;r.a.ajax({url:this.searchObj.url+e,type:"DELETE",data:{},contentType:"application/fhir+json",dataType:"json",success:function(e,a,i){t.$message.success("删除成功"),t.dataDetail=[]},error:function(e){t.dataDetail=[]}})},typeClick:function(e){this.send.type=e},validForm:function(e){"searchName"===e&&(this.searchObj.formInline.name?this.dataListFn():this.$message.error("请输入姓名")),"searchId"===e&&(this.searchObj.formInline.id?this.getDetailFn():this.$message.error("请输入资源id")),"his"===e&&(this.hisObj.formInline.id?this.getHisFn():this.$message.error("请输入资源ID"))},dataListFn:function(){var e=this;r.a.ajax({url:this.searchObj.url,type:"GET",data:{name:this.searchObj.formInline.name},contentType:"application/fhir+json",dataType:"json",success:function(t,a,i){var s=t.entry,n=t.total,r=[];n&&s.forEach((function(e,t){var a=e.resource,i=a.id,s=a.identifier,n=a.name,o=a.telecom,l=a.gender,c=a.birthDate,d=a._birthDate,u=a.address,m=a.contact,f={};f.id=i,f.name=n[0].text,f.idCard=s[0].value,f.socialSecurityCard=s[1].value,f.phone=o[0].value,f.gender=l,f.birthday=c,f.birthdayTime=d.extension[0].valueDateTime,f.state=u[0].state,f.city=u[0].city,f.district=u[0].district,f.area=u[0].city+u[0].district+u[0].line[0],f.line=u[0].line[0],f.postalCode=u[0].postalCode,f.ContactName=m[0].name.text,f.contactNumber=m[0].telecom[0].value,f.contactGender=m[0].gender,r.push(f)})),e.dataList=[],e.dataList=r},error:function(t){e.dataList=[]}})},getDetailFn:function(){var e=this;r.a.ajax({url:this.searchObj.url+this.searchObj.formInline.id,type:"GET",data:{},contentType:"application/fhir+json",dataType:"json",success:function(t,a,i){console.log(t);var s=t.id,n=t.identifier,r=t.name,o=t.telecom,l=t.gender,c=t.birthDate,d=t._birthDate,u=t.address,m=t.contact,f={};f.id=s,f.name=r[0].text,f.idCard=n[0].value,f.socialSecurityCard=n[1].value,f.phone=o[0].value,f.gender=l,f.birthday=c,f.birthdayTime=d.extension[0].valueDateTime,f.state=u[0].state,f.city=u[0].city,f.district=u[0].district,f.area=u[0].city+u[0].district+u[0].line[0],f.line=u[0].line[0],f.postalCode=u[0].postalCode,f.ContactName=m[0].name.text,f.contactNumber=m[0].telecom[0].value,f.contactGender=m[0].gender,e.dataDetail=[],e.dataDetail.push(f)},error:function(t){e.dataDetail=[]}})},getHisFn:function(){var e=this;r.a.ajax({url:this.hisObj.url+this.hisObj.formInline.id+"/_history",type:"GET",data:{},contentType:"application/fhir+json",dataType:"json",success:function(t,a,i){var s=t.entry,n=t.total,r=[];n&&s.forEach((function(e,t){var a=e.resource,i=a.id,s=a.identifier,n=a.name,o=a.telecom,l=a.gender,c=a.birthDate,d=a._birthDate,u=a.address,m=a.contact,f={};f.id=i,f.name=n[0].text,f.idCard=s[0].value,f.socialSecurityCard=s[1].value,f.phone=o[0].value,f.gender=l,f.birthday=c,f.birthdayTime=d.extension[0].valueDateTime,f.state=u[0].state,f.city=u[0].city,f.district=u[0].district,f.area=u[0].city+u[0].district+u[0].line[0],f.line=u[0].line[0],f.postalCode=u[0].postalCode,f.ContactName=m[0].name.text,f.contactNumber=m[0].telecom[0].value,f.contactGender=m[0].gender,r.push(f)})),e.dataHisList=[],e.dataHisList=r},error:function(t){e.dataHisList=[]}})}},computed:{},watch:{}},p=h,y=(a("3715"),Object(u["a"])(p,i,s,!1,null,"7261e8db",null));t["default"]=y.exports},ac6a:function(e,t,a){for(var i=a("cadf"),s=a("0d58"),n=a("2aba"),r=a("7726"),o=a("32e9"),l=a("84f2"),c=a("2b4c"),d=c("iterator"),u=c("toStringTag"),m=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=s(f),p=0;p<h.length;p++){var y,b=h[p],v=f[b],g=r[b],T=g&&g.prototype;if(T&&(T[d]||o(T,d,m),T[u]||o(T,u,b),l[b]=m,v))for(y in i)T[y]||n(T,y,i[y],!0)}},b37b:function(e,t,a){},cdc6:function(e,t,a){"use strict";var i=a("38ef"),s=a.n(i);s.a}}]);